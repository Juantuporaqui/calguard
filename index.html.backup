<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Calendario interactivo para gestionar guardias, d√≠as libres, asuntos propios y vacaciones">
    <meta name="theme-color" content="#a2cffe">
    <title>CalGuard - Calendario de Guardias</title>
    <link rel="manifest" href="/manifest.webmanifest">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="apple-touch-icon" href="/icons/icon-192x192.png">
</head>
<body>
    <!-- Contenedor principal -->
    <main id="app">
        <!-- Header con controles -->
        <header class="app-header">
            <h1 class="app-title">CalGuard</h1>
            <div class="header-controls">
                <button class="theme-toggle" id="theme-toggle" aria-label="Cambiar tema" title="Cambiar tema">
                    üåô
                </button>
                <button class="export-button" id="export-button" aria-label="Exportar datos" title="Exportar datos">
                    üì•
                </button>
            </div>
        </header>

        <!-- Navegaci√≥n de a√±os -->
        <nav class="year-navigation" aria-label="Navegaci√≥n de a√±os">
            <button class="year-nav-btn" id="prev-year" aria-label="A√±o anterior">‚óÄ</button>
            <div class="year-selector">
                <select id="year-select" aria-label="Seleccionar a√±o">
                    <!-- Se llenar√° din√°micamente -->
                </select>
            </div>
            <button class="year-nav-btn" id="next-year" aria-label="A√±o siguiente">‚ñ∂</button>
        </nav>

        <!-- Contenedor del calendario -->
        <section id="year-calendar" class="year-calendar" aria-label="Calendario anual"></section>

        <!-- Overlay para men√∫s desplegables -->
        <div class="overlay" id="overlay" aria-hidden="true"></div>

        <!-- Botones flotantes -->
        <button class="floating-button right"
                id="counter-menu-btn"
                onclick="toggleCounterMenu()"
                aria-label="Mostrar contadores"
                aria-expanded="false"
                title="Contadores">
            ‚ò∞
        </button>
        <button class="floating-button left"
                id="config-menu-btn"
                onclick="toggleConfigMenu()"
                aria-label="Mostrar configuraci√≥n"
                aria-expanded="false"
                title="Configuraci√≥n">
            ‚öôÔ∏è
        </button>

        <!-- Men√∫ de contadores -->
        <aside class="dropdown-menu-counters" id="counter-menu" aria-labelledby="counter-menu-btn">
            <h2 class="menu-title">Contadores</h2>
            <div class="counter-item">
                <span class="counter-label">Libres Acumulados:</span>
                <span id="counter" class="counter-value">0</span>
            </div>
            <div class="counter-item">
                <span class="counter-label">A. Propios Restantes:</span>
                <span id="asunto-counter" class="counter-value">8</span>
            </div>
            <div class="counter-item">
                <span class="counter-label">Vacaciones Restantes:</span>
                <span id="vacaciones-counter" class="counter-value">25</span>
            </div>
            <div class="counter-item">
                <span class="counter-label">Libres Gastados:</span>
                <span id="libres-gastados" class="counter-value">0</span>
            </div>
        </aside>

        <!-- Men√∫ de configuraci√≥n -->
        <aside class="dropdown-menu-config" id="config-menu" aria-labelledby="config-menu-btn">
            <h2 class="menu-title">Configuraci√≥n</h2>
            <form id="config-form" onsubmit="event.preventDefault(); saveConfig();">
                <div class="form-group">
                    <label for="asuntos-anuales">Asuntos Propios Anuales (AP)</label>
                    <input type="number"
                           id="asuntos-anuales"
                           min="0"
                           max="50"
                           value="8"
                           aria-label="Asuntos propios anuales"
                           required>
                </div>
                <div class="form-group">
                    <label for="dias-guardia">D√≠as por Guardia (CMPE)</label>
                    <input type="number"
                           id="dias-guardia"
                           min="1"
                           max="30"
                           value="5"
                           aria-label="D√≠as por guardia"
                           required>
                </div>
                <div class="form-group">
                    <label for="dias-vacaciones">Vacaciones Anuales (VC)</label>
                    <input type="number"
                           id="dias-vacaciones"
                           min="0"
                           max="60"
                           value="25"
                           aria-label="D√≠as de vacaciones anuales"
                           required>
                </div>
                <div class="form-group">
                    <label for="dias-extra">D√≠as Extra</label>
                    <input type="number"
                           id="dias-extra"
                           min="-365"
                           max="365"
                           value="0"
                           aria-label="D√≠as extra"
                           required>
                </div>
                <button type="submit" class="btn btn-primary">Guardar Configuraci√≥n</button>
                <button type="button" class="btn btn-secondary" onclick="mostrarRegistro()">
                    Ver Registro
                </button>
                <button type="button" class="btn btn-warning" onclick="resetCounters()">
                    Resetear Contadores
                </button>
                <button type="button" class="btn btn-success" onclick="enviarWhatsAppAlJefe()">
                    Enviar WhatsApp
                </button>
            </form>
        </aside>

        <!-- Popup de Vacaciones -->
        <div id="vacation-popup" class="vacation-popup" role="dialog" aria-labelledby="vacation-title" aria-modal="true">
            <h3 id="vacation-title">D√≠as de vacaciones</h3>
            <p>D√≠as a descontar:</p>
            <input id="vacation-days" type="number" readonly aria-label="D√≠as de vacaciones a descontar">
            <div class="popup-actions">
                <button id="accept-vacation" class="btn btn-primary">Aceptar</button>
                <button id="cancel-vacation" class="btn btn-secondary">Cancelar</button>
            </div>
        </div>

        <!-- Bot√≥n de recarga -->
        <button id="reloadButton"
                class="reload-button"
                title="Forzar recarga"
                aria-label="Forzar recarga de la aplicaci√≥n">
            üîÑ Recargar
        </button>
    </main>

    <!-- Scripts -->
    <script type="module" src="scripts/utils.js"></script>
    <script type="module" src="scripts/db.js"></script>
    <script type="module" src="scripts/calendar.js"></script>
    <script type="module" src="scripts/events.js"></script>
</body>
</html>
